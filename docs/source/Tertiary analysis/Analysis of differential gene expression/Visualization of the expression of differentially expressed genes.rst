**Visualization of the expression of differentially expressed genes**
=====================================================================

At this stage, we have our tables with all relevant information, including the gene annotations, normalized counts, etc. A helpful plot would be of the normalized counts for these genes for each sample with a heatmap, using the normalized count file generated by DESeq2. 

For users that are running the workflow, these are the tools that would output a heatmap of the normalized counts of differentially expressed genes - "Visualization of the normalized counts" 

* Join datasets side by side on a specified field

* Cut

* heatmap2


For these tools, you don't have to change any parameters or enter any values. For users running the workflow, you can read further down this page if you would like to know how the tools work and what they do (This will also show you the default parameters), or navigate to the next step.

For users running each step seperately, let's get into the nitty-gritties of the "Visualization of the normalized counts" step -

The first tool that is used is "Join datasets side by side on a specified field"

* This tool is mainly used to join the normalized counts that was generated from DESeq2 and the table with the annotated genes with significant p-value and log2 Foldchange

* Search for this tool under "Tools"

* Under "Join", select the output generated from DESeq2 - "Normalized counts"

* Select "Column: 1" under "using column" (The first column is the Gene name)

* Under "with", select the files that was created in the earlier step - "Genes with significant adj p-value & abs(log2(FC)) > 1"

* Under "and column", select "Column: 1" (The first column here is also Gene name and hence can be used to join the two tables)

* Select "No" under "Keep lines of first input that do not join with second input"

* Select "Yes" under "Keep the header lines"

* Click on "Execute"

* The file produced will have more columns that is needed for generating the heatmap and these columns have to be removed


The second tool that is used is "Cut"

* This tool can cut columns from a table so that only certain columns are retained

* Under "Cut columns", enter "c1-c8"

* Under "Delimited by", enter "Tab"

* Select the output of "Join datasets side by side on a specified field" under "From"

* Click on "Execute"

* Rename the output to "Normalized counts for the most differentially expressed genes"


The next tool is "heatmap2"

* This tool plots the heatmap

* Search for "heatmap2" under "Tools"

* Under "Input should have column headers", enter the output of the earlier step - "Normalized counts for the most differentially expressed genes"

* Under "Data transformation", enter "Log2(value) transform my data" (You want to plot the log2 normalized counts to see the differences between the genes)

* Select "Yes" for "Enable data clustering"

* Under "Labeling columns and rows", enter "Label columns and not rows" (If you want to see sample labels and not genes)

* Select "Gradient with 2 colors" under "Type of colormap to use"

* Click on "Execute"

.. image:: /images/heatmap2_normalized_counts.png
   :width: 600
   :alt: Heatmap of normalized counts

